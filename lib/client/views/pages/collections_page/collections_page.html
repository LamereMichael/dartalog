<auth-status (authorizedChanged)="authorizationChanged($event)" require="admin" [showMessage]="true"></auth-status>

<div *ngIf="userAuthorized">
    <div *ngIf="noItemsFound&&!processing" class="no-items">No Collections Found</div>
    <material-list>
        <material-list-item *ngFor="let i of items" (trigger)="selectItem(i)">
            {{i.name}}
        </material-list-item>
    </material-list>

    <modal [visible]="editVisible">
        <material-dialog class="basic-dialog">
            <h3 *ngIf="isNewItem" header>Create</h3>
            <h3 *ngIf="!isNewItem" header>Edit</h3>
            <form (ngSubmit)="onSubmit()" #editForm="ngForm">
                <table>
                    <tr>
                        <td>
                            <material-input [(ngModel)]="model.id" ngControl="id" floatingLabel required autoFocus
                                            label="ID"></material-input>
                            <br/>
                            <material-input [(ngModel)]="model.name" ngControl="name" floatingLabel required
                                            label="Name"></material-input>
                            <br/>
                        </td>
                        <td>
                            <material-checkbox [(ngModel)]="model.publiclyBrowsable" ngControl="publiclyBrowsable"
                                               label="Publicly Browsable"></material-checkbox>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            Users
                            <select [(ngModel)]="selectedUser">
                                <option></option>
                                <option *ngFor="let u of users" [ngValue]="u">
                                    {{u.name}}
                                </option>
                            </select>
                            <material-button (trigger)="addCurator()" raised>Add Curator</material-button>
                            <material-button (trigger)="addBrowser()" raised>Add Browser</material-button>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Curators
                            <material-list>
                                <material-list-item *ngFor="let i of model.curators" (trigger)="removeCurator(i)">
                                    {{i}}
                                </material-list-item>
                            </material-list>
                        </td>
                        <td>
                            Browsers
                            <material-list>
                                <material-list-item *ngFor="let i of model.browsers" (trigger)="removeBrowser(i)">
                                    {{i}}
                                </material-list-item>
                            </material-list>
                        </td>
                    </tr>
                </table>
                <span *ngIf="hasErrorMessage" class="error_output">
                    <glyph icon="error_outline"></glyph>
                    {{errorMessage}}
                </span>
                <input type="submit" style="position: absolute; left: -9999px; width: 1px; height: 1px;"/>
            </form>
            <div footer>
                <table style="width:100%;">
                    <tr>
                        <td>
                            <material-button *ngIf="!isNewItem" icon (trigger)="deleteClicked()">
                                <glyph icon="delete_forever"></glyph>
                            </material-button>
                            <material-button *ngIf="showDeleteConfirmation" (trigger)="deleteConfirmClicked()" raised
                                             class="red">Confirm
                            </material-button>
                        </td>
                        <td style="width:200px">
                            <material-yes-no-buttons yesHighlighted
                                                     yesText="Save" (yes)="onSubmit()"
                                                     noText="Cancel" (no)="editVisible = false"
                                                     [pending]="processing" [yesDisabled]="!editForm.valid">
                            </material-yes-no-buttons>
                        </td>
                    </tr>
                </table>
            </div>
        </material-dialog>
    </modal>
</div>